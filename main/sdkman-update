#!/usr/bin/env bash

set -euo pipefail

#shellcheck disable=SC1091
source "${SCRIPTS_DIR}/functions.bash"
check_no_args "$@"

cp "${SDKMAN_DIR}/etc/config" "${SDKMAN_DIR}/etc/config.orig"
sed --in-place 's/sdkman_auto_answer=false/sdkman_auto_answer=true/g' "${SDKMAN_DIR}/etc/config"
set +u
# shellcheck disable=SC1091
source "${SDKMAN_DIR}/bin/sdkman-init.sh"

log 'Updating SDKMAN metadata'
update_sdkman_metadata
log 'Updated SDKMAN metadata'

log 'Updating SDKMAN packages'
install_sdkman_packages
log 'Updated SDKMAN packages'

log 'Updating Temurin JDKs'
install_latest_tem_jdks
log 'Updated Temurin JDKs'

log 'Setting default JDK'
set_latest_default_jdk
log 'Set default JDK'

set -u
mv "${SDKMAN_DIR}/etc/config.orig" "${SDKMAN_DIR}/etc/config"
